\hypertarget{class_utilities}{}\section{Utilities Class Reference}
\label{class_utilities}\index{Utilities@{Utilities}}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static bstr\+\_\+t \hyperlink{class_utilities_a513806325f04d3f14657656d391fd581_a513806325f04d3f14657656d391fd581}{Get\+Status\+Description} (int status)
\item 
static bstr\+\_\+t \hyperlink{class_utilities_ac2d9ddd205aa23ab4239fe8761a16283_ac2d9ddd205aa23ab4239fe8761a16283}{read\+Line} (string text)
\item 
static \+\_\+bstr\+\_\+t \hyperlink{class_utilities_a02ce22f897bab42c413bbfb90c2022a2_a02ce22f897bab42c413bbfb90c2022a2}{get\+Local\+Address} (\+\_\+bstr\+\_\+t dest)
\item 
static \+\_\+bstr\+\_\+t \hyperlink{class_utilities_aeb41a986f419ffd74a7a499562c19e09_aeb41a986f419ffd74a7a499562c19e09}{getdtb\+Address} ()
\item 
static int \hyperlink{class_utilities_a9cf757f567c9521f6d9867e36db3390a_a9cf757f567c9521f6d9867e36db3390a}{get\+Spectral\+Mode} ()
\item 
static int \hyperlink{class_utilities_a399c7018566d21e1f0f6c0b9698e0169_a399c7018566d21e1f0f6c0b9698e0169}{get\+List\+Mode} ()
\item 
static int \hyperlink{class_utilities_a13331eb352ca5cce3fc25a5af99ea87c_a13331eb352ca5cce3fc25a5af99ea87c}{get\+Preset\+Mode} ()
\item 
static int \hyperlink{class_utilities_aa928f0fb9ad8737b44c5878a37b39be6_aa928f0fb9ad8737b44c5878a37b39be6}{get\+M\+C\+S\+Preset\+Mode} ()
\item 
static float \hyperlink{class_utilities_a7c3601cdf332005fbf77b4d1676945ec_a7c3601cdf332005fbf77b4d1676945ec}{get\+Float} (string text, float min, float max)
\item 
static int \hyperlink{class_utilities_a9f5959c51661e1ec06438d787ffe243a_a9f5959c51661e1ec06438d787ffe243a}{get\+Int} (string text, int min, int max)
\item 
static Dev\+Cntl\+::\+I\+Device\+Ptr \hyperlink{class_utilities_aebdda516a1576b1ad42b841d5eac817c_aebdda516a1576b1ad42b841d5eac817c}{Device} ()
\item 
static Dev\+Cntl\+::\+I\+Device\+Ex\+Ptr \hyperlink{class_utilities_aeb1fd9dbe82fb50e1abaf8e98c225f3a_aeb1fd9dbe82fb50e1abaf8e98c225f3a}{Device\+Ex} ()
\item 
static string \hyperlink{class_utilities_aae385aedbefa8efffbea68f63569f444_aae385aedbefa8efffbea68f63569f444}{Get\+String} (bstr\+\_\+t bstr\+String)
\item 
static \+\_\+variant\+\_\+t \hyperlink{class_utilities_a647591ab58d508945d0dc80db2101624_a647591ab58d508945d0dc80db2101624}{Get1\+D\+Safe\+Array} (long code\+List \mbox{[}$\,$\mbox{]}, int max\+Count)
\item 
static \+\_\+variant\+\_\+t \hyperlink{class_utilities_a5e839ed4340caa91f50582656f9a9a1b_a5e839ed4340caa91f50582656f9a9a1b}{Get1\+D\+Safe\+Array} (float List \mbox{[}$\,$\mbox{]}, int max\+Count)
\item 
static int \hyperlink{class_utilities_a90940686ffd15fdebcd9ed4751e0048e_a90940686ffd15fdebcd9ed4751e0048e}{Get\+Count} (variant\+\_\+t \&v\+Val)
\item 
static \+\_\+variant\+\_\+t \hyperlink{class_utilities_a63dff5c20c4c0e72d53a07b150ab1ab6_a63dff5c20c4c0e72d53a07b150ab1ab6}{Get1\+D\+Safe\+Array\+Element} (variant\+\_\+t \&v\+Val, int index)
\item 
static V\+A\+R\+I\+A\+NT \hyperlink{class_utilities_a0eec445d3ab7471d967af4d5d9daceaa_a0eec445d3ab7471d967af4d5d9daceaa}{U\+T\+C\+To\+Local\+Time} (V\+A\+R\+I\+A\+NT \&vt\+Time)
\item 
static B\+O\+OL \hyperlink{class_utilities_a5037cc6bc036044928fbb0c4d6d90df9_a5037cc6bc036044928fbb0c4d6d90df9}{Is\+Windows2000} ()
\item 
static void \hyperlink{class_utilities_aa6708b10aa75dcf1e10490914a0eb1b1_aa6708b10aa75dcf1e10490914a0eb1b1}{Update\+For\+Windows2K} (Dev\+Cntl\+::\+I\+Device\+Ptr lynx)
\item 
static void \hyperlink{class_utilities_a1026543ba8c95c142180ad642878671d_a1026543ba8c95c142180ad642878671d}{reconstruct\+And\+Output\+Tlist\+Data} (variant\+\_\+t \&tlistD, int time\+Base, bool clear)
\item 
static void \hyperlink{class_utilities_a1f36dd943490f7df78b01b83056e49c6_a1f36dd943490f7df78b01b83056e49c6}{disable\+Acquisition} (Dev\+Cntl\+::\+I\+Device\+Ptr \&lynx, L\+O\+NG input)
\item 
static void \hyperlink{class_utilities_aa881fc2e3136227f05d6afcc562ad98a_aa881fc2e3136227f05d6afcc562ad98a}{disable\+Acquisition} (Dev\+Cntl\+::\+I\+Device\+Ex\+Ptr \&lynx, L\+O\+NG input)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 44 of file utilities.\+h.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_utilities_aebdda516a1576b1ad42b841d5eac817c_aebdda516a1576b1ad42b841d5eac817c}\label{class_utilities_aebdda516a1576b1ad42b841d5eac817c_aebdda516a1576b1ad42b841d5eac817c}} 
\index{Utilities@{Utilities}!Device@{Device}}
\index{Device@{Device}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Device()}{Device()}}
{\footnotesize\ttfamily static Dev\+Cntl\+::\+I\+Device\+Ptr Utilities\+::\+Device (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will create Device pointer.

Pointer 

Definition at line 474 of file utilities.\+h.


\begin{DoxyCode}
475     \{
476         \textcolor{keywordflow}{try}
477         \{
478             DevCntl::IDevicePtr pLynx;
479             \textcolor{keywordflow}{while} (1)
480             \{
481                 \textcolor{comment}{//Create instince of Device pointer}
482                 HRESULT hr = pLynx.CreateInstance (\_\_uuidof(DevCntl::Device));
483                 \textcolor{keywordflow}{if} (FAILED(hr))
484                 \{
485                     \textcolor{keywordflow}{if} (hr != 0x800401f0)
486                         \textcolor{keywordflow}{throw} hr;
487                     \textcolor{keywordflow}{else}
488                     \{
489                         \textcolor{comment}{//Init COM Library...}
490                         \textcolor{keywordflow}{if} (FAILED (hr = CoInitialize (NULL)))
491                             \textcolor{keywordflow}{throw} hr;
492                     \}
493                 \}
494                 \textcolor{keywordflow}{else}
495                     \textcolor{keywordflow}{break};
496             \}
497             \textcolor{keywordflow}{return} pLynx;
498         \}
499         \textcolor{keywordflow}{catch} (...)
500         \{
501             cout << \textcolor{stringliteral}{"GetDevice - Failed to create Lynx interface.\(\backslash\)n"};
502         \}
503         \textcolor{keywordflow}{return} NULL;
504     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aeb1fd9dbe82fb50e1abaf8e98c225f3a_aeb1fd9dbe82fb50e1abaf8e98c225f3a}\label{class_utilities_aeb1fd9dbe82fb50e1abaf8e98c225f3a_aeb1fd9dbe82fb50e1abaf8e98c225f3a}} 
\index{Utilities@{Utilities}!Device\+Ex@{Device\+Ex}}
\index{Device\+Ex@{Device\+Ex}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Device\+Ex()}{DeviceEx()}}
{\footnotesize\ttfamily static Dev\+Cntl\+::\+I\+Device\+Ex\+Ptr Utilities\+::\+Device\+Ex (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will create Device\+Ex pointer.

Pointer 

Definition at line 512 of file utilities.\+h.


\begin{DoxyCode}
513     \{
514         \textcolor{keywordflow}{try}
515         \{
516             DevCntl::IDeviceExPtr pLynx;
517             \textcolor{keywordflow}{while} (1)
518             \{
519                 \textcolor{comment}{//Create instince of Device pointer}
520                 HRESULT hr = pLynx.CreateInstance (\_\_uuidof(DevCntl::DeviceEx));
521                 \textcolor{keywordflow}{if} (FAILED(hr))
522                 \{
523                     \textcolor{keywordflow}{if} (hr != 0x800401f0)
524                         \textcolor{keywordflow}{throw} hr;
525                     \textcolor{keywordflow}{else}
526                     \{
527                         \textcolor{comment}{//Init COM Library...}
528                         \textcolor{keywordflow}{if} (FAILED (hr = CoInitialize (NULL)))
529                             \textcolor{keywordflow}{throw} hr;
530                     \}
531                 \}
532                 \textcolor{keywordflow}{else}
533                     \textcolor{keywordflow}{break};
534             \}
535             \textcolor{keywordflow}{return} pLynx;
536         \}
537         \textcolor{keywordflow}{catch} (...)
538         \{
539             cout << \textcolor{stringliteral}{"DeviceEx - Failed to create Lynx interface.\(\backslash\)n"};
540         \}
541         \textcolor{keywordflow}{return} NULL;
542     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a1f36dd943490f7df78b01b83056e49c6_a1f36dd943490f7df78b01b83056e49c6}\label{class_utilities_a1f36dd943490f7df78b01b83056e49c6_a1f36dd943490f7df78b01b83056e49c6}} 
\index{Utilities@{Utilities}!disable\+Acquisition@{disable\+Acquisition}}
\index{disable\+Acquisition@{disable\+Acquisition}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{disable\+Acquisition()}{disableAcquisition()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily static void Utilities\+::disable\+Acquisition (\begin{DoxyParamCaption}\item[{Dev\+Cntl\+::\+I\+Device\+Ptr \&}]{lynx,  }\item[{L\+O\+NG}]{input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will stop all forms of data acquisition which includes any of the following\+: -\/) S\+CA collection -\/) Auxiliary counter collection -\/) P\+HA -\/) M\+CS -\/) M\+SS -\/) D\+L\+FC -\/) List -\/) Tlist 
\begin{DoxyParams}{Parameters}
{\em lynx.} & The device interface \\
\hline
{\em input.} & The input \\
\hline
\end{DoxyParams}


Definition at line 873 of file utilities.\+h.


\begin{DoxyCode}
874     \{
875         \_bstr\_t user(L\textcolor{stringliteral}{"administrator"});
876         \_bstr\_t pwd(L\textcolor{stringliteral}{"password"});
877         
878         VARIANT args;
879         VariantInit (&args);
880         \textcolor{keywordflow}{try} \{
881             \textcolor{comment}{//Make sure we own the input}
882             lynx->LockInput(user, pwd, input);
883         \}
884         \textcolor{keywordflow}{catch}(...) \{\}
885         
886         \textcolor{keywordflow}{try} \{
887             \textcolor{comment}{//Stop acquisition}
888             lynx->Control(DevCntl::Stop, input, &args);
889         \}
890         \textcolor{keywordflow}{catch}(...) \{\}
891 
892         \textcolor{keywordflow}{try} \{
893             \textcolor{comment}{//Abort acquisition (only needed for MSS or MCS collections)}
894             lynx->Control(DevCntl::Abort, input, &args);
895         \}
896         \textcolor{keywordflow}{catch}(...) \{\}
897         
898         \_variant\_t disable((\textcolor{keywordtype}{int}) 0);
899         \textcolor{keywordflow}{try} \{
900             \textcolor{comment}{//Stop SCA collection}
901             lynx->PutParameter(DevCntl::Input\_SCAstatus, input, &disable);
902         \}
903         \textcolor{keywordflow}{catch}(...) \{\}
904         
905         \textcolor{keywordflow}{try} \{
906             \textcolor{comment}{//Stop aux counters collection}
907             lynx->PutParameter(DevCntl::Counter\_Status, input, &disable);
908         \}
909         \textcolor{keywordflow}{catch}(...) \{\}
910         \textcolor{keywordflow}{try} \{
911             \textcolor{comment}{// see if the osprey was powered off}
912             variant\_t OspreyTime = lynx->GetParameter(DevCntl::Input\_StartTime,input);
913             \textcolor{comment}{// this is the initial start time is less than january 2,2009}
914             variant\_t InitialOspreyTime = \textcolor{stringliteral}{"2009-01-02 00:00:00"};
915             InitialOspreyTime.ChangeType(VT\_DATE);
916             \textcolor{keywordflow}{if} (static\_cast<double>(OspreyTime) <= static\_cast<double>(InitialOspreyTime))
917             \{
918                 \textcolor{comment}{// get the current time from the local computer in the utc format}
919                 SYSTEMTIME systemTime;
920                 variant\_t currentTime;
921                 GetSystemTime(&systemTime);
922                 \textcolor{comment}{// convert to variant time as this is what the osprey expects.}
923                 SystemTimeToFileTime(&systemTime, reinterpret\_cast<LPFILETIME>(&currentTime.llVal));
924                 currentTime.vt = VT\_I8;
925                 lynx->LockInput(user, pwd, static\_cast<short>(0));
926                 \textcolor{keywordflow}{try}
927                 \{
928                     \textcolor{comment}{// set the start time of the next acquisitio}
929                     lynx->PutParameter(DevCntl::System\_DateTime,0,&currentTime);
930                 \}
931                 \textcolor{keywordflow}{catch}(...) 
932                 \{
933                     lynx->UnlockInput(user, pwd, 0L);
934                     \textcolor{keywordflow}{throw};
935                 \}
936                 lynx->UnlockInput(user, pwd, static\_cast<short>(0));
937             \}
938         \}
939         \textcolor{keywordflow}{catch}(...) \{\}
940     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aa881fc2e3136227f05d6afcc562ad98a_aa881fc2e3136227f05d6afcc562ad98a}\label{class_utilities_aa881fc2e3136227f05d6afcc562ad98a_aa881fc2e3136227f05d6afcc562ad98a}} 
\index{Utilities@{Utilities}!disable\+Acquisition@{disable\+Acquisition}}
\index{disable\+Acquisition@{disable\+Acquisition}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{disable\+Acquisition()}{disableAcquisition()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily static void Utilities\+::disable\+Acquisition (\begin{DoxyParamCaption}\item[{Dev\+Cntl\+::\+I\+Device\+Ex\+Ptr \&}]{lynx,  }\item[{L\+O\+NG}]{input }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will stop all forms of data acquisition which includes any of the following\+: -\/) S\+CA collection -\/) Auxiliary counter collection -\/) P\+HA -\/) M\+CS -\/) M\+SS -\/) D\+L\+FC -\/) List -\/) Tlist 
\begin{DoxyParams}{Parameters}
{\em lynx.} & The device interface \\
\hline
{\em input.} & The input \\
\hline
\end{DoxyParams}


Definition at line 955 of file utilities.\+h.


\begin{DoxyCode}
956     \{
957         \_bstr\_t user(L\textcolor{stringliteral}{"administrator"});
958         \_bstr\_t pwd(L\textcolor{stringliteral}{"password"});
959         
960         VARIANT args;
961         VariantInit (&args);
962         \textcolor{keywordflow}{try} \{
963             \textcolor{comment}{//Make sure we own the input}
964             lynx->LockInput(user, pwd, input);
965         \}
966         \textcolor{keywordflow}{catch}(...) \{\}
967         
968         \textcolor{keywordflow}{try} \{
969             \textcolor{comment}{//Stop acquisition}
970             lynx->Control(DevCntl::Stop, input, &args);
971         \}
972         \textcolor{keywordflow}{catch}(...) \{\}
973         
974         \textcolor{keywordflow}{try} \{
975             \textcolor{comment}{//Abort acquisition (only needed for MSS or MCS collections)}
976             lynx->Control(DevCntl::Abort, input, &args);
977         \}
978         \textcolor{keywordflow}{catch}(...) \{\}
979         
980         \_variant\_t disable((\textcolor{keywordtype}{int}) 0);
981         \textcolor{keywordflow}{try} \{
982             \textcolor{comment}{//Stop SCA collection}
983             lynx->PutParameter(DevCntl::Input\_SCAstatus, input, &disable);
984         \}
985         \textcolor{keywordflow}{catch}(...) \{\}
986         
987         \textcolor{keywordflow}{try} \{
988             \textcolor{comment}{//Stop aux counters collection}
989             lynx->PutParameter(DevCntl::Counter\_Status, input, &disable);
990         \}
991         \textcolor{keywordflow}{catch}(...) \{\}
992         \textcolor{keywordflow}{try} \{
993             \textcolor{comment}{// see if the osprey was powered off}
994             variant\_t OspreyTime = lynx->GetParameter(DevCntl::Input\_StartTime,input);
995             \textcolor{comment}{// this is the initial start time is less than january 2,2009}
996             variant\_t InitialOspreyTime = \textcolor{stringliteral}{"2009-01-02 00:00:00"};
997             InitialOspreyTime.ChangeType(VT\_DATE);
998             \textcolor{keywordflow}{if} (static\_cast<double>(OspreyTime) <= static\_cast<double>(InitialOspreyTime))
999             \{
1000                 \textcolor{comment}{// get the current time from the local computer in the utc format}
1001                 SYSTEMTIME systemTime;
1002                 variant\_t currentTime;
1003                 GetSystemTime(&systemTime);
1004                 \textcolor{comment}{// convert to variant time as this is what the osprey expects.}
1005                 SystemTimeToFileTime(&systemTime, reinterpret\_cast<LPFILETIME>(&currentTime.llVal));
1006                 currentTime.vt = VT\_I8;
1007                 lynx->LockInput(user, pwd, static\_cast<short>(0));
1008                 \textcolor{keywordflow}{try}
1009                 \{
1010                     \textcolor{comment}{// set the start time of the next acquisitio}
1011                     lynx->PutParameter(DevCntl::System\_DateTime,0,&currentTime);
1012                 \}
1013                 \textcolor{keywordflow}{catch}(...) 
1014                 \{
1015                     lynx->UnlockInput(user, pwd, 0L);
1016                     \textcolor{keywordflow}{throw};
1017                 \}
1018                 lynx->UnlockInput(user, pwd, static\_cast<short>(0));
1019             \}
1020         \}
1021         \textcolor{keywordflow}{catch}(...) \{\}
1022     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a647591ab58d508945d0dc80db2101624_a647591ab58d508945d0dc80db2101624}\label{class_utilities_a647591ab58d508945d0dc80db2101624_a647591ab58d508945d0dc80db2101624}} 
\index{Utilities@{Utilities}!Get1\+D\+Safe\+Array@{Get1\+D\+Safe\+Array}}
\index{Get1\+D\+Safe\+Array@{Get1\+D\+Safe\+Array}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get1\+D\+Safe\+Array()}{Get1DSafeArray()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily static \+\_\+variant\+\_\+t Utilities\+::\+Get1\+D\+Safe\+Array (\begin{DoxyParamCaption}\item[{long}]{code\+List\mbox{[}$\,$\mbox{]},  }\item[{int}]{max\+Count }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will create a safe array of the list of codes provided.

containing safe arrray 

Definition at line 560 of file utilities.\+h.


\begin{DoxyCode}
561     \{
562         HRESULT hRes = S\_OK;
563         SAFEARRAY *psfArr=NULL;
564         VARIANT vVal;
565         SAFEARRAYBOUND psfBounds[1];
566 
567         \textcolor{keywordflow}{try}
568         \{
569             \textcolor{comment}{//Init}
570             VariantInit(&vVal);
571 
572             \textcolor{comment}{//Setup bounds on safe array for output vVal}
573             psfBounds[0].cElements = maxCount;
574             psfBounds[0].lLbound = 0;
575 
576             \textcolor{comment}{//Create safe array to store parameters}
577             psfArr = SafeArrayCreate(VT\_I4, 1, psfBounds);
578             \textcolor{keywordflow}{if}(psfArr == NULL) 
579                 \textcolor{keywordflow}{throw} E\_OUTOFMEMORY;
580 
581             \textcolor{comment}{//Lock data}
582             hRes = SafeArrayLock(psfArr);
583             \textcolor{keywordflow}{if} (FAILED(hRes)) 
584                 \textcolor{keywordflow}{throw} hRes;
585 
586             \textcolor{keywordtype}{long} plIndex[1];
587             \textcolor{keywordtype}{long} code = 0L;
588 
589             \textcolor{comment}{//Transfer data to safe array}
590             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (long) maxCount; i++) 
591             \{
592                 \textcolor{comment}{//is valid code??}
593                 \textcolor{keywordflow}{if} (codeList [i] <= 0)
594                     \textcolor{keywordflow}{continue};
595 
596                 plIndex[0] = i;
597                 code = codeList [i];
598                 hRes = SafeArrayPutElement (psfArr, plIndex, (\textcolor{keywordtype}{void} *) &code);
599                 \textcolor{keywordflow}{if} (FAILED(hRes)) 
600                     \textcolor{keywordflow}{throw} hRes;
601             \}
602         \}
603         \textcolor{keywordflow}{catch} (...)
604         \{
605             cout << \textcolor{stringliteral}{"Get1DSafeArray error.\(\backslash\)n"};
606         \}
607 
608         \textcolor{keywordflow}{if} (psfArr) 
609         \{
610             SafeArrayUnlock(psfArr);
611             vVal.vt = VT\_ARRAY | VT\_I4;
612             vVal.parray = psfArr;
613         \}
614         \_variant\_t v=\_variant\_t(vVal);
615         VariantClear(&vVal);
616         \textcolor{keywordflow}{return} v;
617     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a5e839ed4340caa91f50582656f9a9a1b_a5e839ed4340caa91f50582656f9a9a1b}\label{class_utilities_a5e839ed4340caa91f50582656f9a9a1b_a5e839ed4340caa91f50582656f9a9a1b}} 
\index{Utilities@{Utilities}!Get1\+D\+Safe\+Array@{Get1\+D\+Safe\+Array}}
\index{Get1\+D\+Safe\+Array@{Get1\+D\+Safe\+Array}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get1\+D\+Safe\+Array()}{Get1DSafeArray()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily static \+\_\+variant\+\_\+t Utilities\+::\+Get1\+D\+Safe\+Array (\begin{DoxyParamCaption}\item[{float}]{List\mbox{[}$\,$\mbox{]},  }\item[{int}]{max\+Count }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will create a safe array of the list of floats

containing safe arrray 

Definition at line 624 of file utilities.\+h.


\begin{DoxyCode}
625     \{
626         HRESULT hRes = S\_OK;
627         SAFEARRAY *psfArr=NULL;
628         VARIANT vVal;
629         SAFEARRAYBOUND psfBounds[1];
630 
631         \textcolor{keywordflow}{try}
632         \{
633             \textcolor{comment}{//Init}
634             VariantInit(&vVal);
635 
636             \textcolor{comment}{//Setup bounds on safe array for output vVal}
637             psfBounds[0].cElements = maxCount;
638             psfBounds[0].lLbound = 0;
639 
640             \textcolor{comment}{//Create safe array to store parameters}
641             psfArr = SafeArrayCreate(VT\_R4, 1, psfBounds);
642             \textcolor{keywordflow}{if}(psfArr == NULL) 
643                 \textcolor{keywordflow}{throw} E\_OUTOFMEMORY;
644 
645             \textcolor{comment}{//Lock data}
646             hRes = SafeArrayLock(psfArr);
647             \textcolor{keywordflow}{if} (FAILED(hRes)) 
648                 \textcolor{keywordflow}{throw} hRes;
649 
650             \textcolor{keywordtype}{long} plIndex[1];
651             \textcolor{keywordtype}{float} v = 0.0F;
652 
653             \textcolor{comment}{//Transfer data to safe array}
654             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (long) maxCount; i++) 
655             \{
656                 
657                 plIndex[0] = i;
658                 v = List [i];
659                 hRes = SafeArrayPutElement (psfArr, plIndex, (\textcolor{keywordtype}{void} *) &v);
660                 \textcolor{keywordflow}{if} (FAILED(hRes)) 
661                     \textcolor{keywordflow}{throw} hRes;
662             \}
663         \}
664         \textcolor{keywordflow}{catch} (...)
665         \{
666             cout << \textcolor{stringliteral}{"Get1DSafeArray error.\(\backslash\)n"};
667         \}
668 
669         \textcolor{keywordflow}{if} (psfArr) 
670         \{
671             SafeArrayUnlock(psfArr);
672             vVal.vt = VT\_ARRAY | VT\_R4;
673             vVal.parray = psfArr;
674         \}
675         \_variant\_t v=\_variant\_t(vVal);
676         VariantClear(&vVal);
677         \textcolor{keywordflow}{return} v;
678     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a63dff5c20c4c0e72d53a07b150ab1ab6_a63dff5c20c4c0e72d53a07b150ab1ab6}\label{class_utilities_a63dff5c20c4c0e72d53a07b150ab1ab6_a63dff5c20c4c0e72d53a07b150ab1ab6}} 
\index{Utilities@{Utilities}!Get1\+D\+Safe\+Array\+Element@{Get1\+D\+Safe\+Array\+Element}}
\index{Get1\+D\+Safe\+Array\+Element@{Get1\+D\+Safe\+Array\+Element}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get1\+D\+Safe\+Array\+Element()}{Get1DSafeArrayElement()}}
{\footnotesize\ttfamily static \+\_\+variant\+\_\+t Utilities\+::\+Get1\+D\+Safe\+Array\+Element (\begin{DoxyParamCaption}\item[{variant\+\_\+t \&}]{v\+Val,  }\item[{int}]{index }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will get specified index value from supplied safe array.

element at given location from safe array 

Definition at line 698 of file utilities.\+h.


\begin{DoxyCode}
699     \{
700         HRESULT hResult = S\_OK;
701         VARIANT vValue;
702         VariantInit(&vValue);
703 
704         \textcolor{keywordtype}{long} plIndex[1];
705         \textcolor{keywordflow}{try}
706         \{
707             \textcolor{keywordflow}{if} (index < \hyperlink{class_utilities_a90940686ffd15fdebcd9ed4751e0048e_a90940686ffd15fdebcd9ed4751e0048e}{GetCount} (vVal))
708             \{
709                 plIndex [0] = index;
710                 \textcolor{keywordflow}{if} ((vVal.vt & VT\_I2) == VT\_I2)
711                 \{
712                     hResult = SafeArrayGetElement (vVal.parray, plIndex, &(vValue.iVal));
713                     vValue.vt = VT\_I2;
714                 \}
715                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((vVal.vt & VT\_I4) == VT\_I4)
716                 \{
717                     hResult = SafeArrayGetElement (vVal.parray, plIndex, &(vValue.lVal));
718                     vValue.vt = VT\_I4;
719                 \}
720                 \textcolor{keywordflow}{else}
721                     hResult = SafeArrayGetElement (vVal.parray, plIndex, &vValue);
722 
723                 \textcolor{keywordflow}{if}(FAILED(hResult))
724                     \textcolor{keywordflow}{throw} hResult;
725             \}
726         \}
727         \textcolor{keywordflow}{catch} (...)
728         \{
729             cout << \textcolor{stringliteral}{"Get1DSafeArrayElement error\(\backslash\)n"};
730         \}
731         \_variant\_t v=\_variant\_t(vValue);
732         VariantClear(&vValue);
733         \textcolor{keywordflow}{return} v;
734     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a90940686ffd15fdebcd9ed4751e0048e_a90940686ffd15fdebcd9ed4751e0048e}\label{class_utilities_a90940686ffd15fdebcd9ed4751e0048e_a90940686ffd15fdebcd9ed4751e0048e}} 
\index{Utilities@{Utilities}!Get\+Count@{Get\+Count}}
\index{Get\+Count@{Get\+Count}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get\+Count()}{GetCount()}}
{\footnotesize\ttfamily static int Utilities\+::\+Get\+Count (\begin{DoxyParamCaption}\item[{variant\+\_\+t \&}]{v\+Val }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will get specified index value from supplied safe array.

element at given location from safe array 

Definition at line 685 of file utilities.\+h.


\begin{DoxyCode}
686     \{
687         \textcolor{keywordflow}{if} (((vVal.vt & VT\_SAFEARRAY) != VT\_SAFEARRAY) && ((vVal.vt & VT\_ARRAY) != VT\_ARRAY))
688             \textcolor{keywordflow}{return} 0;
689 
690         \textcolor{keywordflow}{return} vVal.parray->rgsabound[0].cElements;
691     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aeb41a986f419ffd74a7a499562c19e09_aeb41a986f419ffd74a7a499562c19e09}\label{class_utilities_aeb41a986f419ffd74a7a499562c19e09_aeb41a986f419ffd74a7a499562c19e09}} 
\index{Utilities@{Utilities}!getdtb\+Address@{getdtb\+Address}}
\index{getdtb\+Address@{getdtb\+Address}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{getdtb\+Address()}{getdtbAddress()}}
{\footnotesize\ttfamily static \+\_\+bstr\+\_\+t Utilities\+::getdtb\+Address (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the ip address of the dtb that has been entered via the C++ console

\begin{DoxyReturn}{Returns}
The value 
\end{DoxyReturn}


Definition at line 177 of file utilities.\+h.


\begin{DoxyCode}
178     \{
179         \textcolor{keywordtype}{string} dtbAddr (\textcolor{stringliteral}{""});
180         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
181         \textcolor{keyword}{struct }hostent* remoteHost;
182         
183         \textcolor{keywordflow}{try} 
184         \{
185             \textcolor{keywordflow}{do} 
186             \{
187                 error = \textcolor{keyword}{false};
188                 cout << \textcolor{stringliteral}{"Enter the IP address of your Osprey: (a.b.c.d): "};
189                 dtbAddr = readLine();
190 
191                 \textcolor{keywordflow}{try} 
192                 \{
193                     \textcolor{comment}{//Initialize Socket}
194                     WSADATA wsaData;
195                     \textcolor{keywordflow}{if} (WSAStartup(MAKEWORD(1, 1), &wsaData) != 0) 
196                         \textcolor{keywordflow}{throw} WSAGetLastError();
197 
198                     \textcolor{comment}{//If the user input is an alpha name for the host, use gethostbyname()}
199                     \textcolor{comment}{//If not, get host by addr (assume IPv4)}
200                     \textcolor{keywordflow}{if} (isalpha (dtbAddr [0])) \textcolor{comment}{// host address is a name }
201                     \{
202                         \textcolor{comment}{//if hostname terminated with newline '\(\backslash\)n', remove and zero-terminate }
203                         \textcolor{keywordflow}{if} (dtbAddr [dtbAddr.length () - 1] == \textcolor{charliteral}{'\(\backslash\)n'}) 
204                             dtbAddr [dtbAddr.length () - 1] = \textcolor{charliteral}{'\(\backslash\)0'}; 
205                         remoteHost = gethostbyname (dtbAddr.c\_str ());
206                     \}
207                     \textcolor{keywordflow}{else}  
208                     \{
209                         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} addr = inet\_addr (dtbAddr.c\_str ());
210                         remoteHost = gethostbyaddr ((\textcolor{keywordtype}{char} *)&addr, 4, AF\_INET);
211 
212                         \textcolor{comment}{//It is not catestrophic for this case so punt and}
213                         \textcolor{comment}{//return the IP address}
214                         \textcolor{keywordflow}{if} (NULL == remoteHost) \{
215                             \_bstr\_t bstrdtbAddr (dtbAddr.c\_str());
216                             \textcolor{keywordflow}{return} bstrdtbAddr;
217                         \}
218                     \}
219 
220                     \textcolor{comment}{//check for errors}
221                     \textcolor{keywordflow}{if} (WSAGetLastError() != 0) 
222                         \textcolor{keywordflow}{throw} WSAGetLastError();
223                     \textcolor{keywordflow}{else}
224                     \{
225                         in\_addr * address = (in\_addr *) remoteHost->h\_addr;
226                         dtbAddr = inet\_ntoa (*address);
227                     \}
228                 \}
229                 \textcolor{keywordflow}{catch}(...)
230                 \{
231                     \textcolor{keywordflow}{throw};
232                 \}
233             \} \textcolor{keywordflow}{while}(error);
234         \}
235         \textcolor{keywordflow}{catch}(...)
236         \{
237             \textcolor{keywordtype}{long} lastError = WSAGetLastError();
238             cout << \textcolor{stringliteral}{"getdtbAddress - Error#"} << lastError;
239         \}
240 
241         \textcolor{comment}{//convert to bstr\_t}
242         \_bstr\_t bstrdtbAddr (dtbAddr.c\_str());
243         \textcolor{keywordflow}{return} bstrdtbAddr;
244     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a7c3601cdf332005fbf77b4d1676945ec_a7c3601cdf332005fbf77b4d1676945ec}\label{class_utilities_a7c3601cdf332005fbf77b4d1676945ec_a7c3601cdf332005fbf77b4d1676945ec}} 
\index{Utilities@{Utilities}!get\+Float@{get\+Float}}
\index{get\+Float@{get\+Float}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+Float()}{getFloat()}}
{\footnotesize\ttfamily static float Utilities\+::get\+Float (\begin{DoxyParamCaption}\item[{string}]{text,  }\item[{float}]{min,  }\item[{float}]{max }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the a floating point value that has been entered by the java console \begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 414 of file utilities.\+h.


\begin{DoxyCode}
415     \{
416         \textcolor{keywordtype}{float} val=0.0f;
417         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
418         
419         \textcolor{keywordflow}{try} 
420         \{
421             \textcolor{keywordflow}{do} 
422             \{
423                 error = \textcolor{keyword}{false};
424                 cout << text;
425                 val = (float) atof (readLine ().c\_str ());
426                 \textcolor{keywordflow}{if} ((val < min) || (val > max)) 
427                 \{
428                     error = \textcolor{keyword}{true};
429                 \}
430             \} \textcolor{keywordflow}{while} (error);
431         \}
432         \textcolor{keywordflow}{catch}(...) 
433         \{
434             cout << \textcolor{stringliteral}{"getFloat - Invalid input."};
435         \}
436         \textcolor{keywordflow}{return} val;
437     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a9f5959c51661e1ec06438d787ffe243a_a9f5959c51661e1ec06438d787ffe243a}\label{class_utilities_a9f5959c51661e1ec06438d787ffe243a_a9f5959c51661e1ec06438d787ffe243a}} 
\index{Utilities@{Utilities}!get\+Int@{get\+Int}}
\index{get\+Int@{get\+Int}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+Int()}{getInt()}}
{\footnotesize\ttfamily static int Utilities\+::get\+Int (\begin{DoxyParamCaption}\item[{string}]{text,  }\item[{int}]{min,  }\item[{int}]{max }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the a integer value that has been entered by the java console \begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 444 of file utilities.\+h.


\begin{DoxyCode}
445     \{
446         \textcolor{keywordtype}{int} val=0;
447         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
448         
449         \textcolor{keywordflow}{try} 
450         \{
451             \textcolor{keywordflow}{do} 
452             \{
453                 error = \textcolor{keyword}{false};
454                 cout << text;
455                 val = atoi (readLine ().c\_str ());
456                 \textcolor{keywordflow}{if} ((val < min) || (val > max)) 
457                 \{
458                     error = \textcolor{keyword}{true};
459                 \}
460             \} \textcolor{keywordflow}{while}(error);
461         \}
462         \textcolor{keywordflow}{catch}(...) 
463         \{
464             cout << \textcolor{stringliteral}{"getInt - Invalid input."};
465         \}
466         \textcolor{keywordflow}{return} val;
467     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a399c7018566d21e1f0f6c0b9698e0169_a399c7018566d21e1f0f6c0b9698e0169}\label{class_utilities_a399c7018566d21e1f0f6c0b9698e0169_a399c7018566d21e1f0f6c0b9698e0169}} 
\index{Utilities@{Utilities}!get\+List\+Mode@{get\+List\+Mode}}
\index{get\+List\+Mode@{get\+List\+Mode}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+List\+Mode()}{getListMode()}}
{\footnotesize\ttfamily static int Utilities\+::get\+List\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the list mode to use to acquire data. The list mode is specified via the java console

\begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 290 of file utilities.\+h.


\begin{DoxyCode}
291     \{
292         \textcolor{keywordtype}{int} mode = DevCntl::Pha;
293         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
294         
295         \textcolor{keywordflow}{try} 
296         \{
297             \textcolor{keywordflow}{do} 
298             \{
299                 error = \textcolor{keyword}{false};
300                 cout << \textcolor{stringliteral}{"Select the acquisition mode: (0=List, 1=Tlist) "};
301                 mode = atoi (readLine ().c\_str ());
302                 \textcolor{keywordflow}{if} ((0 != mode) && (1 != mode))
303                 \{
304                     error = \textcolor{keyword}{true};
305                 \}
306                 \textcolor{keywordflow}{else} 
307                 \{
308                     \textcolor{keywordflow}{if} (1 == mode) 
309                         mode = DevCntl::Tlist;
310                     \textcolor{keywordflow}{else} 
311                         mode = DevCntl::List;
312                 \}
313             \} \textcolor{keywordflow}{while} (error);
314         \}
315         \textcolor{keywordflow}{catch}(...) 
316         \{
317             cout << \textcolor{stringliteral}{"getListMode - Invalid input."};
318         \}
319         \textcolor{keywordflow}{return} mode;
320     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a02ce22f897bab42c413bbfb90c2022a2_a02ce22f897bab42c413bbfb90c2022a2}\label{class_utilities_a02ce22f897bab42c413bbfb90c2022a2_a02ce22f897bab42c413bbfb90c2022a2}} 
\index{Utilities@{Utilities}!get\+Local\+Address@{get\+Local\+Address}}
\index{get\+Local\+Address@{get\+Local\+Address}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+Local\+Address()}{getLocalAddress()}}
{\footnotesize\ttfamily static \+\_\+bstr\+\_\+t Utilities\+::get\+Local\+Address (\begin{DoxyParamCaption}\item[{\+\_\+bstr\+\_\+t}]{dest }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the ip address of the local network adapter 
\begin{DoxyParams}{Parameters}
{\em } & \\
\hline
\end{DoxyParams}


Definition at line 125 of file utilities.\+h.


\begin{DoxyCode}
126     \{
127         \textcolor{keywordtype}{string} localAddr (\textcolor{stringliteral}{""});
128         \textcolor{keywordtype}{string} destAddr (dest);
129         
130         \textcolor{keywordflow}{try} 
131         \{
132             ULONG InfSize=0;
133             LONG Stat = GetAdaptersInfo(NULL, &InfSize);
134             \textcolor{keywordflow}{if} (ERROR\_BUFFER\_OVERFLOW != Stat) \textcolor{keywordflow}{throw} Stat;      
135 
136             std::auto\_ptr<char> Inf(\textcolor{keyword}{new} \textcolor{keywordtype}{char}[InfSize]);
137             memset((\textcolor{keywordtype}{char} *) Inf.get(), 0, InfSize);
138 
139             \textcolor{comment}{//Get a list of all available network adapters}
140             Stat = GetAdaptersInfo(reinterpret\_cast<IP\_ADAPTER\_INFO *>(Inf.get()), &InfSize);
141             \textcolor{keywordflow}{if} (NO\_ERROR != Stat) \textcolor{keywordflow}{throw} Stat;
142             
143             DWORD Index = 0;
144             Stat=GetBestInterface(inet\_addr(destAddr.c\_str()), &Index);
145             \textcolor{keywordflow}{if} (NO\_ERROR != Stat) \{\textcolor{keywordflow}{throw} Stat;\}
146 
147             IP\_ADAPTER\_INFO *Info = \textcolor{keyword}{reinterpret\_cast<}IP\_ADAPTER\_INFO *\textcolor{keyword}{>}(Inf.get());
148             \textcolor{keywordflow}{while}(Info) \{               
149                 \textcolor{keywordflow}{if} (Index == Info->Index) \{
150                     localAddr = Info->IpAddressList.IpAddress.String;
151                     \textcolor{keywordflow}{break};
152                 \}                   
153                 Info = Info->Next;
154             \}
155         \}
156         \textcolor{keywordflow}{catch}(LONG lastError)
157         \{       
158             cout << \textcolor{stringliteral}{"getLocalAddress - Error#"} << lastError;
159         \}
160         \textcolor{keywordflow}{catch}(...)
161         \{
162             \textcolor{keywordtype}{long} lastError = WSAGetLastError();
163             cout << \textcolor{stringliteral}{"getLocalAddress - Error#"} << lastError;
164         \}
165 
166         \textcolor{comment}{//convert to bstr\_t}
167         \_bstr\_t bstrlocalAddr (localAddr.c\_str());
168         \textcolor{keywordflow}{return} bstrlocalAddr;
169     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aa928f0fb9ad8737b44c5878a37b39be6_aa928f0fb9ad8737b44c5878a37b39be6}\label{class_utilities_aa928f0fb9ad8737b44c5878a37b39be6_aa928f0fb9ad8737b44c5878a37b39be6}} 
\index{Utilities@{Utilities}!get\+M\+C\+S\+Preset\+Mode@{get\+M\+C\+S\+Preset\+Mode}}
\index{get\+M\+C\+S\+Preset\+Mode@{get\+M\+C\+S\+Preset\+Mode}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+M\+C\+S\+Preset\+Mode()}{getMCSPresetMode()}}
{\footnotesize\ttfamily static int Utilities\+::get\+M\+C\+S\+Preset\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the M\+CS preset mode that has been entered by the java console \begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 372 of file utilities.\+h.


\begin{DoxyCode}
373     \{
374         \textcolor{keywordtype}{int} mode = DevCntl::PresetNone;
375         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
376         
377         \textcolor{keywordflow}{try}
378         \{
379             \textcolor{keywordflow}{do} 
380             \{
381                 error = \textcolor{keyword}{false};
382                 cout << \textcolor{stringliteral}{"Select the acquisition mode: (0=None, 1=Sweeps) "};
383                 mode = atoi (readLine ().c\_str ());
384                 \textcolor{keywordflow}{if} ((0 != mode) && (1 != mode))
385                 \{
386                     error = \textcolor{keyword}{true};
387                 \}
388                 \textcolor{keywordflow}{else} 
389                 \{
390                     \textcolor{keywordflow}{switch}(mode) 
391                     \{
392                     \textcolor{keywordflow}{case} 0:
393                         mode = DevCntl::PresetNone;
394                         \textcolor{keywordflow}{break};
395                     \textcolor{keywordflow}{default}:
396                         mode = DevCntl::PresetSweeps;
397                         \textcolor{keywordflow}{break};
398                     \}
399                 \}
400             \} \textcolor{keywordflow}{while} (error);
401         \}
402         \textcolor{keywordflow}{catch}(...) 
403         \{
404             cout << \textcolor{stringliteral}{"getMCSPresetMode - Invalid input."};
405         \}
406         \textcolor{keywordflow}{return} mode;
407     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a13331eb352ca5cce3fc25a5af99ea87c_a13331eb352ca5cce3fc25a5af99ea87c}\label{class_utilities_a13331eb352ca5cce3fc25a5af99ea87c_a13331eb352ca5cce3fc25a5af99ea87c}} 
\index{Utilities@{Utilities}!get\+Preset\+Mode@{get\+Preset\+Mode}}
\index{get\+Preset\+Mode@{get\+Preset\+Mode}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+Preset\+Mode()}{getPresetMode()}}
{\footnotesize\ttfamily static int Utilities\+::get\+Preset\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the preset mode that has been entered by the java console \begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 327 of file utilities.\+h.


\begin{DoxyCode}
328     \{
329         \textcolor{keywordtype}{int} mode = DevCntl::PresetNone;
330         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
331         
332         \textcolor{keywordflow}{try} 
333         \{
334             \textcolor{keywordflow}{do} 
335             \{
336                 error = \textcolor{keyword}{false};
337                 cout << \textcolor{stringliteral}{"Select the acquisition mode: (0=None, 1=Real, 2=Live) "};
338                 mode = atoi (readLine ().c\_str ());
339                 \textcolor{keywordflow}{if} ((0 != mode) && (1 != mode) && (2 != mode))
340                 \{
341                     error = \textcolor{keyword}{true};
342                 \}
343                 \textcolor{keywordflow}{else} 
344                 \{
345                     \textcolor{keywordflow}{switch}(mode) 
346                     \{
347                     \textcolor{keywordflow}{case} 0:
348                         mode = DevCntl::PresetNone;
349                         \textcolor{keywordflow}{break};
350                     \textcolor{keywordflow}{case} 1:
351                         mode = DevCntl::PresetRealTime;
352                         \textcolor{keywordflow}{break};
353                     \textcolor{keywordflow}{default}:
354                         mode = DevCntl::PresetLiveTime;
355                         \textcolor{keywordflow}{break};
356                     \}
357                 \}
358             \} \textcolor{keywordflow}{while} (error);
359         \}
360         \textcolor{keywordflow}{catch}(...) 
361         \{
362             cout << \textcolor{stringliteral}{"getPresetMode - Invalid input."};
363         \}
364         \textcolor{keywordflow}{return} mode;
365     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a9cf757f567c9521f6d9867e36db3390a_a9cf757f567c9521f6d9867e36db3390a}\label{class_utilities_a9cf757f567c9521f6d9867e36db3390a_a9cf757f567c9521f6d9867e36db3390a}} 
\index{Utilities@{Utilities}!get\+Spectral\+Mode@{get\+Spectral\+Mode}}
\index{get\+Spectral\+Mode@{get\+Spectral\+Mode}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{get\+Spectral\+Mode()}{getSpectralMode()}}
{\footnotesize\ttfamily static int Utilities\+::get\+Spectral\+Mode (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return the spectral acquisition mode that has been entered by the java console \begin{DoxyReturn}{Returns}
. The value 
\end{DoxyReturn}


Definition at line 251 of file utilities.\+h.


\begin{DoxyCode}
252     \{
253         \textcolor{keywordtype}{int} mode = DevCntl::Pha;
254         \textcolor{keywordtype}{bool} error = \textcolor{keyword}{false};
255 
256         \textcolor{keywordflow}{try} 
257         \{
258             \textcolor{keywordflow}{do} 
259             \{
260                 error = \textcolor{keyword}{false};
261                 cout << \textcolor{stringliteral}{"Select the acquisition mode: (0=Pha, 1=Dlfc) "};
262                 mode = atoi (readLine().c\_str ());
263                 \textcolor{keywordflow}{if} ((0 != mode) && (1 != mode))
264                 \{
265                     error=\textcolor{keyword}{true};
266                 \}
267                 \textcolor{keywordflow}{else} 
268                 \{
269                     \textcolor{keywordflow}{if} (1 == mode) 
270                         mode = DevCntl::Dlfc;
271                     \textcolor{keywordflow}{else} 
272                         mode = DevCntl::Pha;
273                 \}
274             \} \textcolor{keywordflow}{while}(error);
275         \}
276         \textcolor{keywordflow}{catch}(...) 
277         \{
278             cout << \textcolor{stringliteral}{"getSpectralMode - Invalid input."};
279         \}
280         \textcolor{keywordflow}{return} mode;
281     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a513806325f04d3f14657656d391fd581_a513806325f04d3f14657656d391fd581}\label{class_utilities_a513806325f04d3f14657656d391fd581_a513806325f04d3f14657656d391fd581}} 
\index{Utilities@{Utilities}!Get\+Status\+Description@{Get\+Status\+Description}}
\index{Get\+Status\+Description@{Get\+Status\+Description}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get\+Status\+Description()}{GetStatusDescription()}}
{\footnotesize\ttfamily static bstr\+\_\+t Utilities\+::\+Get\+Status\+Description (\begin{DoxyParamCaption}\item[{int}]{status }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will return a string that describes the meaning of the various states contained in the status parameter.


\begin{DoxyParams}{Parameters}
{\em status.} & The status returned by the device \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
. The description 
\end{DoxyReturn}


Definition at line 81 of file utilities.\+h.


\begin{DoxyCode}
81                                                    \{
82         bstr\_t statMsg=\textcolor{stringliteral}{"Idle "};
83         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Busy)) statMsg=\textcolor{stringliteral}{"Busy "};
84         \textcolor{keywordflow}{if} (0 != (status&DevCntl::APZinprog)) statMsg+=\textcolor{stringliteral}{"APZ "};
85         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Diagnosing)) statMsg+=\textcolor{stringliteral}{"Diagnosing "};
86         \textcolor{keywordflow}{if} (0 != (status&DevCntl::ExternalTriggerEvent)) statMsg+=\textcolor{stringliteral}{"Ext trig "};
87         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Fault)) statMsg+=\textcolor{stringliteral}{"Fault "};
88         \textcolor{keywordflow}{if} (0 != (status&DevCntl::GroupComplete)) statMsg+=\textcolor{stringliteral}{"Group complete "};
89         \textcolor{keywordflow}{if} (0 != (status&DevCntl::HVramping)) statMsg+=\textcolor{stringliteral}{"HVPS ramping "};
90         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Idle)) statMsg+=\textcolor{stringliteral}{"Idle "};
91         \textcolor{keywordflow}{if} (0 != (status&DevCntl::PresetCompReached)) statMsg+=\textcolor{stringliteral}{"Comp Preset reached "};
92         \textcolor{keywordflow}{if} (0 != (status&DevCntl::PresetTimeReached)) statMsg+=\textcolor{stringliteral}{"Time Preset reached "};
93         \textcolor{keywordflow}{if} (0 != (status&DevCntl::PresetSweepsReached)) statMsg+=\textcolor{stringliteral}{"Sweeps Preset reached "};
94         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Rebooting)) statMsg+=\textcolor{stringliteral}{"Rebooting "};
95         \textcolor{keywordflow}{if} (0 != (status&DevCntl::UpdatingImage)) statMsg+=\textcolor{stringliteral}{"Updating firmware "};
96         \textcolor{keywordflow}{if} (0 != (status&DevCntl::Waiting)) statMsg+=\textcolor{stringliteral}{"Waiting "};
97         \textcolor{keywordflow}{if} (0 != (status&DevCntl::AcqNotStarted)) statMsg+=\textcolor{stringliteral}{"Acquisition not started because preset already
       reached "};
98         \textcolor{keywordflow}{if} (0 != (status&DevCntl::OverflowStop)) statMsg+=\textcolor{stringliteral}{"Acquisition stopped because channel contents
       overflowed "};
99         \textcolor{keywordflow}{if} (0 != (status&DevCntl::ExternalStop)) statMsg+=\textcolor{stringliteral}{"Acquisition stopped because of external stop "};
100         \textcolor{keywordflow}{if} (0 != (status&DevCntl::ManualStop)) statMsg+=\textcolor{stringliteral}{"Acquisition stopped because of manual stop "};
101         \textcolor{keywordflow}{return} statMsg;
102     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aae385aedbefa8efffbea68f63569f444_aae385aedbefa8efffbea68f63569f444}\label{class_utilities_aae385aedbefa8efffbea68f63569f444_aae385aedbefa8efffbea68f63569f444}} 
\index{Utilities@{Utilities}!Get\+String@{Get\+String}}
\index{Get\+String@{Get\+String}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Get\+String()}{GetString()}}
{\footnotesize\ttfamily static string Utilities\+::\+Get\+String (\begin{DoxyParamCaption}\item[{bstr\+\_\+t}]{bstr\+String }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will convert bstr to string

Definition at line 549 of file utilities.\+h.


\begin{DoxyCode}
550     \{
551         \textcolor{keywordtype}{string} strString (bstrString);
552         \textcolor{keywordflow}{return} strString;
553     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a5037cc6bc036044928fbb0c4d6d90df9_a5037cc6bc036044928fbb0c4d6d90df9}\label{class_utilities_a5037cc6bc036044928fbb0c4d6d90df9_a5037cc6bc036044928fbb0c4d6d90df9}} 
\index{Utilities@{Utilities}!Is\+Windows2000@{Is\+Windows2000}}
\index{Is\+Windows2000@{Is\+Windows2000}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Is\+Windows2000()}{IsWindows2000()}}
{\footnotesize\ttfamily static B\+O\+OL Utilities\+::\+Is\+Windows2000 (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will check if current operating system is Windows 2000 system or not.

if Windows 2000 Opearing System else F\+A\+L\+SE 

Definition at line 782 of file utilities.\+h.


\begin{DoxyCode}
783     \{
784         BOOL bIsW2K = FALSE;
785         OSVERSIONINFO VersionInfo;
786         ZeroMemory (&VersionInfo, \textcolor{keyword}{sizeof} (OSVERSIONINFO));
787         VersionInfo.dwOSVersionInfoSize = \textcolor{keyword}{sizeof} (OSVERSIONINFO);
788         \textcolor{keywordflow}{if} (GetVersionEx (&VersionInfo) == TRUE)
789         \{
790             \textcolor{comment}{//is this operating system Windows 2000??}
791             \textcolor{keywordflow}{if} (VersionInfo.dwMajorVersion == 5 && VersionInfo.dwMinorVersion == 0)
792                 bIsW2K = TRUE;
793         \}
794 
795         \textcolor{keywordflow}{return} bIsW2K;
796     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_ac2d9ddd205aa23ab4239fe8761a16283_ac2d9ddd205aa23ab4239fe8761a16283}\label{class_utilities_ac2d9ddd205aa23ab4239fe8761a16283_ac2d9ddd205aa23ab4239fe8761a16283}} 
\index{Utilities@{Utilities}!read\+Line@{read\+Line}}
\index{read\+Line@{read\+Line}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{read\+Line()}{readLine()}}
{\footnotesize\ttfamily static bstr\+\_\+t Utilities\+::read\+Line (\begin{DoxyParamCaption}\item[{string}]{text }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will read information from the standard input stream


\begin{DoxyParams}{Parameters}
{\em text.} & The text to display to the user on the console \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
. The text entered by the user 
\end{DoxyReturn}


Definition at line 111 of file utilities.\+h.


\begin{DoxyCode}
112     \{
113         cout << text;
114         \textcolor{keywordtype}{string} line (\textcolor{stringliteral}{""});
115         cin >> line;
116         \textcolor{keywordflow}{return} bstr\_t(line.data());
117     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a1026543ba8c95c142180ad642878671d_a1026543ba8c95c142180ad642878671d}\label{class_utilities_a1026543ba8c95c142180ad642878671d_a1026543ba8c95c142180ad642878671d}} 
\index{Utilities@{Utilities}!reconstruct\+And\+Output\+Tlist\+Data@{reconstruct\+And\+Output\+Tlist\+Data}}
\index{reconstruct\+And\+Output\+Tlist\+Data@{reconstruct\+And\+Output\+Tlist\+Data}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{reconstruct\+And\+Output\+Tlist\+Data()}{reconstructAndOutputTlistData()}}
{\footnotesize\ttfamily static void Utilities\+::reconstruct\+And\+Output\+Tlist\+Data (\begin{DoxyParamCaption}\item[{variant\+\_\+t \&}]{tlistD,  }\item[{int}]{time\+Base,  }\item[{bool}]{clear }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will reconstruct the time events for time stamped list mode before displaying on output 
\begin{DoxyParams}{Parameters}
{\em tlist\+D.} & The time stamped list data buffer \\
\hline
{\em time\+Base.} & The timebase (nS) \\
\hline
{\em clear.} & Whether to reset the time counter \\
\hline
\end{DoxyParams}


Definition at line 822 of file utilities.\+h.


\begin{DoxyCode}
823     \{
824         \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{long} ROLLOVERBIT=0x00008000;       
825         \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \_\_int64 RolloverTime=0;
826         \textcolor{keywordflow}{if} (clear) RolloverTime=0;
827         LONG numE = \hyperlink{class_utilities_a90940686ffd15fdebcd9ed4751e0048e_a90940686ffd15fdebcd9ed4751e0048e}{Utilities::GetCount} (tlistD);
828         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} recTime=0, recEvent=0;
829         \textcolor{keywordtype}{unsigned} \_\_int64 Time=0;
830         \textcolor{keywordtype}{double} cnv=timeBase;
831         LONG i=0;
832 
833         cnv /= 1000; \textcolor{comment}{//Convert to uS}
834         \textcolor{keywordflow}{for}(Time=0, i=0; i<numE; i+=2) \{    
835             recEvent = \hyperlink{class_utilities_a63dff5c20c4c0e72d53a07b150ab1ab6_a63dff5c20c4c0e72d53a07b150ab1ab6}{Utilities::Get1DSafeArrayElement} (tlistD, i);
836             recTime = \hyperlink{class_utilities_a63dff5c20c4c0e72d53a07b150ab1ab6_a63dff5c20c4c0e72d53a07b150ab1ab6}{Utilities::Get1DSafeArrayElement} (tlistD, i + 1);
837             \textcolor{comment}{// Changes done on 01/19/2010}
838             \textcolor{comment}{// To show the Events and The Rollover time correctly}
839             \textcolor{keywordflow}{if} (!(recTime&ROLLOVERBIT)) \{
840                 Time = RolloverTime | (recTime & 0x7FFF);
841                 cout << \textcolor{stringliteral}{"\(\backslash\)nEvent\(\backslash\)t"} << recEvent << \textcolor{stringliteral}{"\(\backslash\)t Time (uS): "} << Time << endl;
842             \}
843             \textcolor{keywordflow}{else} \{
844                 \textcolor{keywordtype}{long} LSBofTC = 0;
845                 \textcolor{keywordtype}{long} MSBofTC = 0;
846                 LSBofTC |= (recTime & 0x7FFF) << 15;
847                 MSBofTC |= recEvent << 30;
848                 RolloverTime = MSBofTC | LSBofTC;  
849 
850                 \textcolor{comment}{//goto next event}
851                 \textcolor{comment}{//continue;}
852                 cout << \textcolor{stringliteral}{"\(\backslash\)nRollover Time\(\backslash\)t"} << RolloverTime << endl;
853             \}
854 
855             \textcolor{comment}{//cout << "\(\backslash\)nEvent: " << recEvent << "; Time (uS): " << Time*cnv << endl;           }
856             \textcolor{comment}{//Time=0;}
857         \}
858     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_aa6708b10aa75dcf1e10490914a0eb1b1_aa6708b10aa75dcf1e10490914a0eb1b1}\label{class_utilities_aa6708b10aa75dcf1e10490914a0eb1b1_aa6708b10aa75dcf1e10490914a0eb1b1}} 
\index{Utilities@{Utilities}!Update\+For\+Windows2K@{Update\+For\+Windows2K}}
\index{Update\+For\+Windows2K@{Update\+For\+Windows2K}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{Update\+For\+Windows2\+K()}{UpdateForWindows2K()}}
{\footnotesize\ttfamily static void Utilities\+::\+Update\+For\+Windows2K (\begin{DoxyParamCaption}\item[{Dev\+Cntl\+::\+I\+Device\+Ptr}]{lynx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will set appropriate flags to get correct data (specially for V\+T\+\_\+\+I8 data types) from the lynx device. Note\+: By setting this flag to get Time, we will loose milli second precision. (Please refer to Communication Libraries document for more information) @ 

Definition at line 806 of file utilities.\+h.


\begin{DoxyCode}
807     \{
808         VARIANT vWin2K;
809         VariantInit (&vWin2K);
810         vWin2K.boolVal = VARIANT\_TRUE;
811         vWin2K.vt = VT\_BOOL;
812         lynx->PutProperty (\_bstr\_t (\textcolor{stringliteral}{"ConvertFileTime2OleTime"}), &vWin2K);
813     \}
\end{DoxyCode}
\mbox{\Hypertarget{class_utilities_a0eec445d3ab7471d967af4d5d9daceaa_a0eec445d3ab7471d967af4d5d9daceaa}\label{class_utilities_a0eec445d3ab7471d967af4d5d9daceaa_a0eec445d3ab7471d967af4d5d9daceaa}} 
\index{Utilities@{Utilities}!U\+T\+C\+To\+Local\+Time@{U\+T\+C\+To\+Local\+Time}}
\index{U\+T\+C\+To\+Local\+Time@{U\+T\+C\+To\+Local\+Time}!Utilities@{Utilities}}
\subsubsection{\texorpdfstring{U\+T\+C\+To\+Local\+Time()}{UTCToLocalTime()}}
{\footnotesize\ttfamily static V\+A\+R\+I\+A\+NT Utilities\+::\+U\+T\+C\+To\+Local\+Time (\begin{DoxyParamCaption}\item[{V\+A\+R\+I\+A\+NT \&}]{vt\+Time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

This method will convert U\+TC time to local time.

time in variant\+\_\+t 

Definition at line 741 of file utilities.\+h.


\begin{DoxyCode}
742     \{
743         \textcolor{comment}{//Clear the Now systemtime structure}
744         SYSTEMTIME SystemTime, Now;
745         memset (&SystemTime, 0, \textcolor{keyword}{sizeof} (SystemTime));
746         memset (&Now, 0, \textcolor{keyword}{sizeof} (Now));
747 
748         \textcolor{comment}{//Get the timezone infomation structure.}
749         TIME\_ZONE\_INFORMATION Zone;
750         DWORD a = GetTimeZoneInformation (&Zone);
751 
752         \textcolor{comment}{//Convert the Device variant to a systemtime structure}
753         \textcolor{keywordflow}{if} (vtTime.vt != VT\_DATE)
754         \{
755             \_\_int64 T = vtTime.llVal;
756             \hyperlink{struct___f_i_l_e_t_i_m_e}{FILETIME} UtcTime = *(\textcolor{keyword}{reinterpret\_cast<}\hyperlink{struct___f_i_l_e_t_i_m_e}{FILETIME} *\textcolor{keyword}{>}(&T));
757             FileTimeToSystemTime (&UtcTime, &SystemTime);
758         \}
759         \textcolor{keywordflow}{else}
760             VariantTimeToSystemTime (vtTime.dblVal, &SystemTime);
761 
762         \textcolor{comment}{//Using the Device systemtime and the current time zone information}
763         \textcolor{comment}{//Calculate the current local time.}
764         SystemTimeToTzSpecificLocalTime (&Zone, &SystemTime, &Now);
765 
766         \textcolor{comment}{// Convert the current local time to a variant}
767         \textcolor{keywordtype}{double} dTemp = 0.0;
768         SystemTimeToVariantTime(&Now, &dTemp);
769 
770         VARIANT v;
771         VariantInit (&v);
772         v.date = dTemp;
773         v.vt = VT\_DATE;
774         \textcolor{keywordflow}{return} v;
775     \}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Project1/\+Dependencies/\+Canberra\+\_\+\+V1/include/utilities.\+h\end{DoxyCompactItemize}
